<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Service Status Monitor</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f8fafc;
            min-height: 100vh;
            padding: 40px 20px;
            color: #1e293b;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
        }

        .category-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 500;
            margin-left: 10px;
            background: #e2e8f0;
            color: #64748b;
        }

        .service-count {
            color: #64748b;
            font-size: 0.9rem;
            margin-top: 8px;
        }

        header {
            text-align: center;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: #0f172a;
            font-weight: 600;
        }

        .subtitle {
            color: #64748b;
            font-size: 1rem;
            font-weight: 400;
        }

        .last-updated {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-top: 12px;
        }

        .status-table {
            width: 100%;
            border-collapse: collapse;
            background: #ffffff;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05), 0 4px 12px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
        }

        .status-table th,
        .status-table td {
            padding: 16px 24px;
            text-align: left;
        }

        .status-table th {
            background: #f8fafc;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.5px;
            color: #64748b;
            border-bottom: 1px solid #e2e8f0;
        }

        .status-table tr {
            border-bottom: 1px solid #f1f5f9;
            transition: background 0.15s ease;
        }

        .status-table tbody tr:hover {
            background: #f8fafc;
        }

        .status-table tr:last-child {
            border-bottom: none;
        }

        .service-name {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
            color: #1e293b;
        }

        .service-icon {
            width: 36px;
            height: 36px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            background: #f1f5f9;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .status-operational {
            background: #ecfdf5;
            color: #059669;
        }

        .status-operational .status-dot {
            background: #10b981;
        }

        .status-degraded {
            background: #fffbeb;
            color: #d97706;
        }

        .status-degraded .status-dot {
            background: #f59e0b;
        }

        .status-outage {
            background: #fef2f2;
            color: #dc2626;
        }

        .status-outage .status-dot {
            background: #ef4444;
        }

        .status-unknown {
            background: #f1f5f9;
            color: #64748b;
        }

        .status-unknown .status-dot {
            background: #94a3b8;
            animation: none;
        }

        .status-loading {
            background: #eff6ff;
            color: #2563eb;
        }

        .status-loading .status-dot {
            background: #3b82f6;
        }

        .description {
            color: #64748b;
            font-size: 0.85rem;
        }

        .refresh-btn {
            display: block;
            margin: 30px auto 0;
            padding: 12px 28px;
            background: #0f172a;
            border: none;
            border-radius: 10px;
            color: #fff;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .refresh-btn:hover {
            background: #1e293b;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(15, 23, 42, 0.15);
        }

        .refresh-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .summary {
            display: flex;
            justify-content: center;
            gap: 48px;
            margin-bottom: 32px;
            flex-wrap: wrap;
        }

        .summary-item {
            text-align: center;
            padding: 20px 28px;
            background: #ffffff;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
            border: 1px solid #e2e8f0;
        }

        .summary-count {
            font-size: 2rem;
            font-weight: 700;
        }

        .summary-label {
            font-size: 0.8rem;
            color: #64748b;
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .operational-count { color: #059669; }
        .issues-count { color: #d97706; }
        .outage-count { color: #dc2626; }

        .cors-note {
            text-align: center;
            margin-top: 24px;
            padding: 12px 20px;
            background: #f1f5f9;
            border-radius: 8px;
            font-size: 0.8rem;
            color: #64748b;
        }

        .cors-note a {
            color: #2563eb;
            text-decoration: none;
        }

        .cors-note a:hover {
            text-decoration: underline;
        }

        @media (max-width: 600px) {
            body { padding: 20px 16px; }
            h1 { font-size: 1.6rem; }
            .status-table th,
            .status-table td { padding: 12px 16px; }
            .description { display: none; }
            .summary { gap: 12px; }
            .summary-item { padding: 16px 20px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Cloud Service Status Monitor</h1>
            <p class="subtitle">Real-time status of major cloud providers, developer tools, and business services</p>
            <p class="service-count">Monitoring <span id="service-count">0</span> services</p>
            <p class="last-updated">Last updated: <span id="update-time">Loading...</span></p>
        </header>

        <div class="summary">
            <div class="summary-item">
                <div class="summary-count operational-count" id="operational-count">-</div>
                <div class="summary-label">Operational</div>
            </div>
            <div class="summary-item">
                <div class="summary-count issues-count" id="issues-count">-</div>
                <div class="summary-label">Issues</div>
            </div>
            <div class="summary-item">
                <div class="summary-count outage-count" id="outage-count">-</div>
                <div class="summary-label">Outages</div>
            </div>
        </div>

        <table class="status-table">
            <thead>
                <tr>
                    <th>Service</th>
                    <th>Status</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody id="status-body">
                <tr>
                    <td colspan="3" style="text-align: center; padding: 40px;">
                        Loading service status...
                    </td>
                </tr>
            </tbody>
        </table>

        <button class="refresh-btn" id="refresh-btn" onclick="refreshStatus()">
            Refresh Status
        </button>

        <div class="cors-note">
            Status data fetched via public APIs. Some services may show "Unknown" due to network restrictions.
            <br>Click on any service to visit their official status page.
        </div>
    </div>

    <script>
        // CORS proxy configuration for browser-based requests
        // Most status APIs don't allow direct browser requests, so we use a proxy
        const CORS_PROXIES = [
            'https://api.allorigins.win/raw?url=',
            'https://corsproxy.io/?'
        ];
        let currentProxyIndex = 0;

        function getCorsProxyUrl(url) {
            return CORS_PROXIES[currentProxyIndex] + encodeURIComponent(url);
        }

        // Service configurations with their public status API endpoints
        // These services use Statuspage.io which provides a standard API format
        const services = [
            // === CLOUD PROVIDERS ===
            {
                name: 'AWS',
                icon: 'ðŸ”¶',
                statusUrl: 'https://status.aws.amazon.com/data.json',
                pageUrl: 'https://health.aws.amazon.com/health/status',
                category: 'Cloud'
            },
            {
                name: 'Microsoft Azure',
                icon: 'ðŸ”·',
                statusUrl: 'https://azure.status.microsoft/api/v2/status.json',
                pageUrl: 'https://azure.status.microsoft/en-us/status',
                category: 'Cloud'
            },
            {
                name: 'Google Cloud',
                icon: 'ðŸŒ',
                statusUrl: 'https://status.cloud.google.com/incidents.json',
                pageUrl: 'https://status.cloud.google.com/',
                category: 'Cloud'
            },
            {
                name: 'DigitalOcean',
                icon: 'ðŸŒŠ',
                statusUrl: 'https://status.digitalocean.com/api/v2/status.json',
                pageUrl: 'https://status.digitalocean.com',
                category: 'Cloud'
            },
            {
                name: 'Linode',
                icon: 'ðŸŸ¢',
                statusUrl: 'https://status.linode.com/api/v2/status.json',
                pageUrl: 'https://status.linode.com',
                category: 'Cloud'
            },
            {
                name: 'Heroku',
                icon: 'ðŸŸ£',
                statusUrl: 'https://status.heroku.com/api/v2/status.json',
                pageUrl: 'https://status.heroku.com',
                category: 'Cloud'
            },

            // === MICROSOFT SERVICES ===
            {
                name: 'Microsoft 365',
                icon: 'ðŸ“Š',
                statusUrl: 'https://portal.office.com/api/servicestatus/status.json',
                pageUrl: 'https://status.office.com/',
                category: 'Microsoft'
            },
            {
                name: 'Microsoft Teams',
                icon: 'ðŸ‘¥',
                statusUrl: 'https://portal.office.com/api/servicestatus/status.json',
                pageUrl: 'https://status.office.com/',
                category: 'Microsoft'
            },
            {
                name: 'Outlook',
                icon: 'ðŸ“§',
                statusUrl: 'https://portal.office.com/api/servicestatus/status.json',
                pageUrl: 'https://status.office.com/',
                category: 'Microsoft'
            },

            // === GOOGLE SERVICES ===
            {
                name: 'Google Workspace',
                icon: 'ðŸ“¨',
                statusUrl: 'https://www.google.com/appsstatus/json/en',
                pageUrl: 'https://www.google.com/appsstatus/dashboard/',
                category: 'Google'
            },
            {
                name: 'YouTube',
                icon: 'â–¶ï¸',
                statusUrl: 'https://www.google.com/appsstatus/json/en',
                pageUrl: 'https://www.google.com/appsstatus/dashboard/',
                category: 'Google'
            },

            // === COMMUNICATION ===
            {
                name: 'Slack',
                icon: 'ðŸ’¬',
                statusUrl: 'https://status.slack.com/api/v2.0.0/current',
                pageUrl: 'https://status.slack.com',
                category: 'Communication'
            },
            {
                name: 'Discord',
                icon: 'ðŸŽ®',
                statusUrl: 'https://discordstatus.com/api/v2/status.json',
                pageUrl: 'https://discordstatus.com',
                category: 'Communication'
            },
            {
                name: 'Zoom',
                icon: 'ðŸ“¹',
                statusUrl: 'https://status.zoom.us/api/v2/status.json',
                pageUrl: 'https://status.zoom.us',
                category: 'Communication'
            },
            {
                name: 'Twilio',
                icon: 'ðŸ“±',
                statusUrl: 'https://status.twilio.com/api/v2/status.json',
                pageUrl: 'https://status.twilio.com',
                category: 'Communication'
            },

            // === DEVELOPER TOOLS ===
            {
                name: 'GitHub',
                icon: 'ðŸ™',
                statusUrl: 'https://www.githubstatus.com/api/v2/status.json',
                pageUrl: 'https://www.githubstatus.com',
                category: 'Developer'
            },
            {
                name: 'GitLab',
                icon: 'ðŸ¦Š',
                statusUrl: 'https://status.gitlab.com/api/v2/status.json',
                pageUrl: 'https://status.gitlab.com',
                category: 'Developer'
            },
            {
                name: 'Bitbucket',
                icon: 'ðŸª£',
                statusUrl: 'https://bitbucket.status.atlassian.com/api/v2/status.json',
                pageUrl: 'https://bitbucket.status.atlassian.com',
                category: 'Developer'
            },
            {
                name: 'Jira',
                icon: 'ðŸ“‹',
                statusUrl: 'https://jira.status.atlassian.com/api/v2/status.json',
                pageUrl: 'https://jira.status.atlassian.com',
                category: 'Developer'
            },
            {
                name: 'Confluence',
                icon: 'ðŸ“',
                statusUrl: 'https://confluence.status.atlassian.com/api/v2/status.json',
                pageUrl: 'https://confluence.status.atlassian.com',
                category: 'Developer'
            },
            {
                name: 'Trello',
                icon: 'ðŸ“Œ',
                statusUrl: 'https://trello.status.atlassian.com/api/v2/status.json',
                pageUrl: 'https://trello.status.atlassian.com',
                category: 'Developer'
            },
            {
                name: 'CircleCI',
                icon: 'âš¡',
                statusUrl: 'https://status.circleci.com/api/v2/status.json',
                pageUrl: 'https://status.circleci.com',
                category: 'Developer'
            },
            {
                name: 'npm',
                icon: 'ðŸ“¦',
                statusUrl: 'https://status.npmjs.org/api/v2/status.json',
                pageUrl: 'https://status.npmjs.org',
                category: 'Developer'
            },
            {
                name: 'Vercel',
                icon: 'â–²',
                statusUrl: 'https://www.vercel-status.com/api/v2/status.json',
                pageUrl: 'https://www.vercel-status.com',
                category: 'Developer'
            },
            {
                name: 'Netlify',
                icon: 'ðŸŒ',
                statusUrl: 'https://www.netlifystatus.com/api/v2/status.json',
                pageUrl: 'https://www.netlifystatus.com',
                category: 'Developer'
            },
            {
                name: 'Docker',
                icon: 'ðŸ³',
                statusUrl: 'https://status.docker.com/api/v2/status.json',
                pageUrl: 'https://status.docker.com',
                category: 'Developer'
            },
            {
                name: 'HashiCorp',
                icon: 'ðŸ”§',
                statusUrl: 'https://status.hashicorp.com/api/v2/status.json',
                pageUrl: 'https://status.hashicorp.com',
                category: 'Developer'
            },
            {
                name: 'Sentry',
                icon: 'ðŸ”',
                statusUrl: 'https://status.sentry.io/api/v2/status.json',
                pageUrl: 'https://status.sentry.io',
                category: 'Developer'
            },

            // === INFRASTRUCTURE & CDN ===
            {
                name: 'Cloudflare',
                icon: 'â˜ï¸',
                statusUrl: 'https://www.cloudflarestatus.com/api/v2/status.json',
                pageUrl: 'https://www.cloudflarestatus.com',
                category: 'Infrastructure'
            },
            {
                name: 'Fastly',
                icon: 'âš¡',
                statusUrl: 'https://status.fastly.com/api/v2/status.json',
                pageUrl: 'https://status.fastly.com',
                category: 'Infrastructure'
            },

            // === DATABASES & DATA ===
            {
                name: 'MongoDB Atlas',
                icon: 'ðŸƒ',
                statusUrl: 'https://status.mongodb.com/api/v2/status.json',
                pageUrl: 'https://status.mongodb.com',
                category: 'Database'
            },
            {
                name: 'Redis Cloud',
                icon: 'ðŸ”´',
                statusUrl: 'https://status.redis.io/api/v2/status.json',
                pageUrl: 'https://status.redis.io',
                category: 'Database'
            },
            {
                name: 'Datadog',
                icon: 'ðŸ“Š',
                statusUrl: 'https://status.datadoghq.com/api/v2/status.json',
                pageUrl: 'https://status.datadoghq.com',
                category: 'Database'
            },
            {
                name: 'New Relic',
                icon: 'ðŸ“ˆ',
                statusUrl: 'https://status.newrelic.com/api/v2/status.json',
                pageUrl: 'https://status.newrelic.com',
                category: 'Database'
            },

            // === BUSINESS & PRODUCTIVITY ===
            {
                name: 'Notion',
                icon: 'ðŸ““',
                statusUrl: 'https://status.notion.so/api/v2/status.json',
                pageUrl: 'https://status.notion.so',
                category: 'Business'
            },
            {
                name: 'Figma',
                icon: 'ðŸŽ¨',
                statusUrl: 'https://status.figma.com/api/v2/status.json',
                pageUrl: 'https://status.figma.com',
                category: 'Business'
            },
            {
                name: 'Linear',
                icon: 'ðŸ“',
                statusUrl: 'https://linearstatus.com/api/v2/status.json',
                pageUrl: 'https://linearstatus.com',
                category: 'Business'
            },
            {
                name: 'Intercom',
                icon: 'ðŸ’¬',
                statusUrl: 'https://www.intercomstatus.com/api/v2/status.json',
                pageUrl: 'https://www.intercomstatus.com',
                category: 'Business'
            },

            // === PAYMENTS ===
            {
                name: 'Stripe',
                icon: 'ðŸ’³',
                statusUrl: 'https://status.stripe.com/api/v2/status.json',
                pageUrl: 'https://status.stripe.com',
                category: 'Payments'
            },
            {
                name: 'PayPal',
                icon: 'ðŸ’°',
                statusUrl: 'https://www.paypal-status.com/api/v2/status.json',
                pageUrl: 'https://www.paypal-status.com',
                category: 'Payments'
            },
            {
                name: 'Shopify',
                icon: 'ðŸ›’',
                statusUrl: 'https://status.shopify.com/api/v2/status.json',
                pageUrl: 'https://status.shopify.com',
                category: 'Payments'
            },

            // === IDENTITY & SECURITY ===
            {
                name: 'Okta',
                icon: 'ðŸ”',
                statusUrl: 'https://status.okta.com/api/v2/status.json',
                pageUrl: 'https://status.okta.com',
                category: 'Security'
            },
            {
                name: 'Auth0',
                icon: 'ðŸ”‘',
                statusUrl: 'https://status.auth0.com/api/v2/status.json',
                pageUrl: 'https://status.auth0.com',
                category: 'Security'
            },
            {
                name: 'PagerDuty',
                icon: 'ðŸš¨',
                statusUrl: 'https://status.pagerduty.com/api/v2/status.json',
                pageUrl: 'https://status.pagerduty.com',
                category: 'Security'
            },

            // === AI & ML SERVICES ===
            {
                name: 'OpenAI',
                icon: 'ðŸ¤–',
                statusUrl: 'https://status.openai.com/api/v2/status.json',
                pageUrl: 'https://status.openai.com',
                category: 'AI'
            },
            {
                name: 'Anthropic',
                icon: 'ðŸ§ ',
                statusUrl: 'https://status.anthropic.com/api/v2/status.json',
                pageUrl: 'https://status.anthropic.com',
                category: 'AI'
            },
            {
                name: 'Hugging Face',
                icon: 'ðŸ¤—',
                statusUrl: 'https://status.huggingface.co/api/v2/status.json',
                pageUrl: 'https://status.huggingface.co',
                category: 'AI'
            },
            {
                name: 'Stability AI',
                icon: 'ðŸŽ¨',
                statusUrl: 'https://status.stability.ai/api/v2/status.json',
                pageUrl: 'https://status.stability.ai',
                category: 'AI'
            },
            {
                name: 'Replicate',
                icon: 'ðŸ”„',
                statusUrl: 'https://status.replicate.com/api/v2/status.json',
                pageUrl: 'https://status.replicate.com',
                category: 'AI'
            },
            {
                name: 'Cohere',
                icon: 'ðŸ’¬',
                statusUrl: 'https://status.cohere.com/api/v2/status.json',
                pageUrl: 'https://status.cohere.com',
                category: 'AI'
            },

            // === SOCIAL & CONSUMER ===
            {
                name: 'Reddit',
                icon: 'ðŸ“±',
                statusUrl: 'https://www.redditstatus.com/api/v2/status.json',
                pageUrl: 'https://www.redditstatus.com',
                category: 'Social'
            },
            {
                name: 'Dropbox',
                icon: 'ðŸ“¦',
                statusUrl: 'https://status.dropbox.com/api/v2/status.json',
                pageUrl: 'https://status.dropbox.com',
                category: 'Social'
            },
            {
                name: 'Box',
                icon: 'ðŸ“',
                statusUrl: 'https://status.box.com/api/v2/status.json',
                pageUrl: 'https://status.box.com',
                category: 'Social'
            }
        ];

        // Map Statuspage.io indicator to our status classes
        function getStatusClass(indicator) {
            switch (indicator) {
                case 'none':
                    return 'status-operational';
                case 'minor':
                    return 'status-degraded';
                case 'major':
                case 'critical':
                    return 'status-outage';
                default:
                    return 'status-unknown';
            }
        }

        // Get human-readable status text
        function getStatusText(indicator) {
            switch (indicator) {
                case 'none':
                    return 'Operational';
                case 'minor':
                    return 'Degraded';
                case 'major':
                    return 'Major Outage';
                case 'critical':
                    return 'Critical';
                default:
                    return 'Unknown';
            }
        }

        // Parse different status API formats
        function parseStatusResponse(service, data) {
            // Standard Statuspage.io format
            if (data.status && data.status.indicator !== undefined) {
                return {
                    indicator: data.status.indicator,
                    description: data.status.description || 'Status available'
                };
            }

            // Slack API format
            if (data.status !== undefined && typeof data.status === 'string') {
                const slackStatus = data.status.toLowerCase();
                if (slackStatus === 'ok' || slackStatus === 'active') {
                    return { indicator: 'none', description: 'All Systems Operational' };
                } else if (slackStatus === 'active incident' || slackStatus === 'notice') {
                    return { indicator: 'minor', description: data.status };
                } else {
                    return { indicator: 'major', description: data.status };
                }
            }

            // AWS format - check for current events/issues
            if (data.archive || data.current) {
                const hasIssues = (data.current && data.current.length > 0);
                if (hasIssues) {
                    return { indicator: 'minor', description: 'Service issues reported' };
                }
                return { indicator: 'none', description: 'All Systems Operational' };
            }

            // Google Apps Status format
            if (Array.isArray(data)) {
                const hasIssues = data.some(item =>
                    item.status && item.status !== 'AVAILABLE' && item.status !== 'OK'
                );
                if (hasIssues) {
                    return { indicator: 'minor', description: 'Some services experiencing issues' };
                }
                return { indicator: 'none', description: 'All Systems Operational' };
            }

            // Google Cloud incidents format
            if (data.incidents || data.most_recent_incidents) {
                const incidents = data.incidents || data.most_recent_incidents || [];
                const activeIncidents = incidents.filter(i =>
                    i.end === undefined || i.end === null || i.currently_affected_locations
                );
                if (activeIncidents.length > 0) {
                    return { indicator: 'minor', description: `${activeIncidents.length} active incident(s)` };
                }
                return { indicator: 'none', description: 'All Systems Operational' };
            }

            // If we got valid JSON but can't parse the format, assume operational
            // (better UX than showing unknown for working services)
            return { indicator: 'none', description: 'Status page accessible' };
        }

        // Fetch status for a single service with CORS proxy fallback
        async function fetchServiceStatus(service) {
            // Try direct fetch first, then fallback to CORS proxies
            const urlsToTry = [
                service.statusUrl,
                ...CORS_PROXIES.map(proxy => proxy + encodeURIComponent(service.statusUrl))
            ];

            for (const url of urlsToTry) {
                try {
                    const controller = new AbortController();
                    const timeoutId = setTimeout(() => controller.abort(), 8000); // 8s timeout

                    const response = await fetch(url, {
                        signal: controller.signal,
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    clearTimeout(timeoutId);

                    if (!response.ok) continue; // Try next URL

                    const data = await response.json();
                    const parsed = parseStatusResponse(service, data);

                    return {
                        name: service.name,
                        icon: service.icon,
                        pageUrl: service.pageUrl,
                        category: service.category,
                        indicator: parsed.indicator,
                        description: parsed.description
                    };
                } catch (error) {
                    // Continue to next URL on error
                    continue;
                }
            }

            // All attempts failed
            return {
                name: service.name,
                icon: service.icon,
                pageUrl: service.pageUrl,
                category: service.category,
                indicator: 'unknown',
                description: 'Unable to fetch status'
            };
        }

        // Render the status table
        function renderTable(statuses) {
            const tbody = document.getElementById('status-body');

            // Sort by category then name for better organization
            const categoryOrder = ['Cloud', 'AI', 'Microsoft', 'Google', 'Communication', 'Developer', 'Infrastructure', 'Database', 'Business', 'Payments', 'Security', 'Social'];
            statuses.sort((a, b) => {
                const catA = categoryOrder.indexOf(a.category) !== -1 ? categoryOrder.indexOf(a.category) : 999;
                const catB = categoryOrder.indexOf(b.category) !== -1 ? categoryOrder.indexOf(b.category) : 999;
                if (catA !== catB) return catA - catB;
                return a.name.localeCompare(b.name);
            });

            let html = '';
            for (const status of statuses) {
                const statusClass = getStatusClass(status.indicator);
                const statusText = getStatusText(status.indicator);

                html += `
                    <tr>
                        <td>
                            <a href="${status.pageUrl}" target="_blank" rel="noopener" class="service-name" style="color: inherit; text-decoration: none;">
                                <span class="service-icon">${status.icon}</span>
                                ${status.name}
                                <span class="category-badge">${status.category || 'Other'}</span>
                            </a>
                        </td>
                        <td>
                            <span class="status-badge ${statusClass}">
                                <span class="status-dot"></span>
                                ${statusText}
                            </span>
                        </td>
                        <td class="description">${status.description}</td>
                    </tr>
                `;
            }

            tbody.innerHTML = html;

            // Update service count
            document.getElementById('service-count').textContent = statuses.length;
        }

        // Update summary counts
        function updateSummary(statuses) {
            let operational = 0;
            let issues = 0;
            let outages = 0;

            for (const status of statuses) {
                switch (status.indicator) {
                    case 'none':
                        operational++;
                        break;
                    case 'minor':
                        issues++;
                        break;
                    case 'major':
                    case 'critical':
                        outages++;
                        break;
                    default:
                        issues++; // Count unknown as issues
                }
            }

            document.getElementById('operational-count').textContent = operational;
            document.getElementById('issues-count').textContent = issues;
            document.getElementById('outage-count').textContent = outages;
        }

        // Main function to refresh all statuses
        async function refreshStatus() {
            const btn = document.getElementById('refresh-btn');
            btn.disabled = true;
            btn.textContent = 'Refreshing...';

            // Show loading state
            const tbody = document.getElementById('status-body');
            document.getElementById('service-count').textContent = services.length;
            tbody.innerHTML = services.map(service => `
                <tr>
                    <td>
                        <span class="service-name">
                            <span class="service-icon">${service.icon}</span>
                            ${service.name}
                            <span class="category-badge">${service.category || 'Other'}</span>
                        </span>
                    </td>
                    <td>
                        <span class="status-badge status-loading">
                            <span class="status-dot"></span>
                            Checking...
                        </span>
                    </td>
                    <td class="description">Fetching status...</td>
                </tr>
            `).join('');

            // Fetch all statuses in parallel
            const statuses = await Promise.all(services.map(fetchServiceStatus));

            // Render results
            renderTable(statuses);
            updateSummary(statuses);

            // Update timestamp
            const now = new Date();
            document.getElementById('update-time').textContent = now.toLocaleString();

            btn.disabled = false;
            btn.textContent = 'Refresh Status';
        }

        // Initial load
        refreshStatus();

        // Auto-refresh every 60 seconds
        setInterval(refreshStatus, 60000);
    </script>
</body>
</html>
